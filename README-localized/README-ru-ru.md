---
page_type: sample
products:
- office
- office-365
- office-outlook
languages:
- javascript
description: "Это пример реализации веб-запросов на оплату и оплату услуг в Outlook"
urlFragment: outlook-payments-sample
extensions:
  contentType: samples
  createdDate: "4/24/2018 7:43:42 AM"
---

# Образец Node.js платежей в веб-перехватчике Outlook

В этом примере демонстрируется реализация запросов на платеж и завершенных веб-перехватчиков для [Выплаты в службе Outlook](https://docs.microsoft.com/outlook/payments/).

## Необходимые компоненты

Перед тем как приступить к работе с этим образцом, необходимо [зарегистрироваться на панели мониторинга Outlook](https://docs.microsoft.com/outlook/payments/partner-dashboard) и необходимо иметь учетную запись подключения [Stripe](https://stripe.com/connect).

Также необходимо установить [Node.js](https://nodejs.org) и [NPM](https://www.npmjs.com/).

## Запуск приложения

1. Установите зависимости с помощью:

    ```bash
    npm install
    ```

1. Запустите образец с помощью:

    ```bash
    npm start
    ```

## Использование ngrok для локального запуска

При запуске примера локально можно получить доступ к нему с помощью `http://localhost:3333`. Служба платежей должна поддерживать связь с веб-перехватчиком с Интернет, поэтому запуск на localhost не будет работать. Однако с помощью [ngrok](https://ngrok.com/)можно создать общедоступный адрес, с которого временно можно связаться с localhost.

Откройте командную строку или интерпретатор команд и выполните следующую команду:

```bash
ngrok http 3333 -host-header=localhost:3333
```

Результат должен выглядеть примерно так:

```bash
ngrok by @inconshreveable                                     (Ctrl+C to quit)

Session Status                online
Account                       Jason Johnston (Plan: Free)
Version                       2.2.8
Region                        United States (us)
Web Interface                 http://127.0.0.1:4040
Forwarding                    http://68cd84ed.ngrok.io -> localhost:3333
Forwarding                    https://68cd84ed.ngrok.io -> localhost:3333
```

Скопируйте URL-адрес HTTPS из второй записи `Пересылки`. В приведенном выше результате URL-адрес для копирования `https://68cd84ed.ngrok.io`. Используя этот URL-адрес в качестве основы, давайте создадим два URL-адреса: один из них — веб-перехватчик запроса на платеж (ngrok URL + `/api/update`), а второй — веб перехватчик по завершению платежа (ngrok URL + `/api/complete`). Например, с помощью URL-адреса из приведенного выше примера выводится следующее:

```
https://68cd84ed.ngrok.io/api/update
https://68cd84ed.ngrok.io/api/complete
```

> **Примечание.** Оставьте ngrok включенным, чтобы эти URL оставались активными.

Обновите URL-адреса веб-перехватчика на информационной панели партнера, используя эти URL-адреса для проверки.

![Снимок экрана: URL-адреса веб-перехватчика в области "платежи в Outlook"](readme-images/dashboard-webhooks.PNG)

## Генерация тестового сообщения о платеже

См. [Начало работы с платежами в Outlook](https://docs.microsoft.com/outlook/payments/get-started#send-the-test-payment-request), чтобы узнать, как отправить тестовое сообщение себе.

## Участие

Мы всегда рады предложениям и помощи в работе над проектом.
Обычно для добавления своих вариантов необходимо принять Лицензионное соглашение с участником (CLA), заявив, что вы имеете право предоставлять и предоставляете нам права на использование своего варианта.
Подробности см. на сайте [https://cla.microsoft.com](https://cla.microsoft.com).

Когда вы будете отправлять запрос на вытягивание, CLA-бот автоматически определит, нужно ли вам предоставить CLA и соответствующим образом изменит внешний вид запроса на вытягивание (например, добавит метку, комментарий).
Просто следуйте инструкциям бота.
Это нужно будет сделать всего один раз для добавления своих вариантов во все репозитории, использующие наш CLA.

Этот проект соответствует [Правилам поведения разработчиков открытого кода Майкрософт](https://opensource.microsoft.com/codeofconduct/).
Дополнительные сведения см. в разделе [часто задаваемых вопросов о правилах поведения](https://opensource.microsoft.com/codeofconduct/faq/).
Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).
